---
title: "2026-02-11"
format: 
  html: 
    toc: true
    toc-location: right
    toc-title: "Contents"
    toc-depth: 6
    number-sections: true
    smooth-scroll: true
editor: visual
---

# 표본

-   모집단에서 추출한 샘플사이즈(표본크기) N개

# 표본설계

-   편향된 표본이 얻어지지 않도록 항상 논문에서 데이터에 대해 잘 설명

-   ex) site 효과 site = 데이터가 얻어진 곳

-   스캐너 효과 → 스캐너가 다름 → 이 데이터를 그냥 쓸 수도 있지만, 보통은 harmonization이란 걸 한다.

# 랜덤표본

-   랜덤 : 무작위로 뽑는데, 표본설계 하에

# 아직 모르는의 의미?

-   표본을 아직 안 뽑았다. → 그래서 X는 확률 변수라고 부른다.

# 확률변수의 분포 키에 대해서 히스토그램을 그려보니 정규분포랑 비슷하다

## → 정규분포를 따른다고 가정할 수 있다 → X ∼ N(μ, σ 2)

### → 확률을 어떻게 표기할까?

### P(X \> 170) probability P(X = 170) X = x X = 170

-   X1, X2,⋯, XN ∼ N(μ, σ 2)

-   X1, X2,⋯, XN → 얘네를 랜덤 표본이라 한다.

-   서로 독립적이고 동일한 분포를 따르는 확률변수들의 집합

-   모집단 분포가 확률밀도함수 f(x; θ) 로 주어짐.

-   이때, 모집단에서 독립적으로 추출된 표본 X1, X2, . . . , Xn 은 다음을 따름:

-   X1, X2, . . . , Xn iid ∼ f(x; θ), θ ∈ Ω

# θ

-   우리가 모르는 모수 벡터일수도 있음

-   정규분포면 세타=(평균, 표준편차)

-   세타도 어떤 값을 가질 것임

    ## 평균이 갖는 값의 범위는?

    -   

        ### (-무한대, +무한대) 표준편차는? (0,+무한대)

        ### Ω는 모수공간 = 모수들이 값을 가지는 범위

# 모수, 모수 공간

-   모형: 정규분포 N(μ, σ2)

-   모수: 평균 μ, 분산 σ2

![](images/clipboard-2372505880.png)

## 예시

### 공정의 불량률 조사

불량?

-   이 제품이 불량(1)이냐 아니냐(0) X는 불량 여부

-   X1? → 처음 관측한 대상/표본

-   P(X1 = 1)=X1이 1일 확률 =X1이 불량일 확률 = p

### 하천의 오염도 조사

-   측정 대상: 하천 물의 단위 부피 당 부유생물 수

-   모형: 포아송 분포 Poisson(λ)

-   모수: 평균 부유생물 수 λ

-   모수공간:

    Ω = {λ : λ ≥ 0}

# 통계량의 정의

-   X1, X2,⋯, XN

-   랜덤 표본의 함수

-   −∞ \< X \< ∞

-   f(x1, x2,.... xN )

-   다변수함수

-   x값이 여러 개 → 표본을 추출하면 그 값을 알 수 있음

## 예시

### 베르누이 분포

-   불량률 p 를 모수로 하는 베르누이 분포 Bernoulli(p)에서

-   랜덤표본 X1, X2, . . . , Xn 을 고려함.

-   불량이냐(1) 아니냐(0)

-   표본에서 불량 개수의 합:

    X1 + X2 + ⋯ + Xn

-   → 1의 합

-   → 무슨의미? 불량품의 개수

-   표본에서의 불량률(표본비율, sample proportion):

    p\^ = X1 + X2 + ⋯ + Xn / n

-   p\^ 는 통계량(statistic) 에 해당함.

## 랜덤표본의 평균과 분산

### 표본평균 (sample mean)

-   g(X1,..., Xn) = X ̄ = 1 / n \* (X1 + X2 + ⋯ + Xn)

-   표본평균은 통계량 → 랜덤표본의 함수로 정의되기 때문에

### 표본분산 (sample variance)

-   표본평균 X ̄ 와 표본분산 S\^2 또한 통계량(statistics) 이다.

-   → 추정을 하냐 안 하냐에 따라 n으로 나누는지( 추정X ), n-1로 나누는지 (추정O) 달라진다.

-   → 추정?

-   → 랜덤표본으로 우리가 모르는 모집단에 대해서 합리적인 추론을 한다.

-   → 추정을 한다는 건, 우리가 얻은 데이터가 모집단에서 얻은 일부의 샘플이라고 본다.

-   ex) A반에 속함 수학시험 성적 10,20,30

-   → 성적의 평균, 표준편차를 구할 때, 우리의 목적?

-   → 1) 그냥 우리 반의 수학 성적의 평균, 표준편차가 얼마?

-   2\) 우리 반 데이터를 이용해서, 우리 학교 전체 학생들의 수학 성적 분포를 알고 싶다. **(추정)**

## 순서통계량

-   x1 = 170 x2 = 200 x3 = 10

-   → 데이터가 안 정해지면 그 순서를 정할 수 없지만,

-   → 데이터가 정해지면 그 순서를 정할 수 있음

-   10 \< 170 \< 200

-   모집단 분포가 연속형인 경우, 모집단에서 랜덤표본 X1, X2, . . . , Xn 을 크기순으로 정렬하면:

-   X(1) \< X(2) \< ⋯ \< X(n)

-   이때, 정렬된 표본 X(i) 들을 순서통계량 (order statistics) 이라고 한다.

# 비모수적 방법

-   비모수적 방법에 쓰는 개념

-   → 분포를 가정하지 않는다

-   → 모델링을 해놓지 않는다

-   → 우리 데이터가 어떤 특정 분포를 따른다고 가정하지 않는다.

-   → 그래서 우리가 가진 데이터만을 갖고 놀아야 함

-   ex) 윌콕슨 순위합 검정

-   1,2,5,6,7,8 − − 0, ++

-   귀무가설: 평균은 5일 것이다

# 표본 중앙값

-   확률밀도함수에의 정의: 그 값을 기준으로 위아래로 0.5, 0.5 확률 우리가 실제 손으로 셀 수 있는 데이터에 대해서는 다음 정의를 따름 순서통계량 중 가운데 값을 나타내는 통계량을 표본중앙값 (sample median) 이라고 함.

-    표본중앙값은 모집단 분포의 중심 부분을 추측하는 데 사용되는 통계량이다.

-   ex) 홀수 개의 데이터의 얻었다

-   0, 1,2,4,5,7,10 2,4,5 → 요기서의 중앙값? → 4

-   ex) 짝수 개의 데이터를 얻었다.

-   4, 5, 6 , 7 , 10, 15

→ 중간에 2개의 평균 (6+7)/2 → 이게 중앙값

# 랜덤표본, 평균, 기댓값

-   평균은 분포의 위치를 나타내는 값

<!-- -->

-   확률변수 X의 확률분포의 평균을 X의 기댓값

# 확률밀도함수에서의 평균

-   X ∼ N(μ, σ 2)

-   → 여기서의 평균은? 뮤

-   → 기호로 기댓값 E(X) = μ expected value 기댓값 = 확률밀도함수의 평균 기댓값이란 건 "모집단의 평균"

-   → 우리가 모르는 값이다.

# 정규확률변수의 표준화

-   X ∼ N(μ, σ 2)

-   확률변수 X는 정규분포를 따른다

-   → 확률변수 X는 정규확률변수이다

-   → X의 표준화 변수 Z의 분포는?

-   Z ∼ N(0, 1)

# 자유도(degree of freedom)

-   X1, X2,⋯, XN → 얘네를 랜덤 표본이라 한다.

-   → 샘플사이즈가 N이다 표본크기가 N이다.

-   → 데이터를 N개 얻었다.

-   → 평균을 구할 수 있음 X ̄

-   → 우리가 데이터를 얻어서 계산을 하면, 평균값은 정해져 있다.

-   → 이 계산 전에는 N개의 데이터가 뭘 가져도 되었다.

-   ex)키 데이터라고 하자. N명에 대해서 조사한다

-   → 우리가 데이터 얻기 전에는 N명의 데이터가 뭔지 모른다.

-   → 근데 조사하면 평균값은 정해진다.

-   → 그러면 자동적으로 표본분산값도 정해진다.

-   → 그래서 평균값이 고정 된 것이나 마찬가지이다.

-   → 그래서 처음에는 N명의 데이터에 대해 관측하지 않았을 경우, N개 모두 어떤 값을 가질지 모른다.

-   → 근데, 예를 들어, 평균이 100이라 하자.

-   ex) 3명의 데이터를 모은다 X1 = 1000 X2 = 100000 X3 =?

-   → X3는 항상 값이 고정되어야 한다.

-   → 어떤 값을 가질 자유가 없다.

-   → 처음 자유도는 얼마였지? : N

-   → 평균이 고정되면 N − 1

# 표본분포 (sampling distribution)

## 표본 평균의 분포

-   랜덤표본을 1번 뽑음 : X1, X2, . . . , Xn ∼ N(mu, sigma)

-   → 2번, 3번,.... → 뽑을 때마다, 값이 달라진다.

-   → 랜덤표본의 값이 달라진다 = 통계량도 달라진다 (통계량 = 랜덤표본의 함수)

-   → 표본을 뽑을 때마다 값이 달라진다.

-   → 근데 이 값의 분포가 있을 것이다.

-   → 표본이 정규분포이면, 표본평균도 정규분포이다.

-   X ̄ ∼ N(mu, sigma/n)

# 중심극한정리 (CLT)

-   표본의 분포(지수분포, 이항분포, 포아송분포)가 정규분포가 아니어도 표본평균의 분포 는 "근사적으로" 정규분포이다.,

-   → 표본이 어느 정도 커야 함.

-   → 표본크기가 30정도 있어야 함.

-   → 정규분포 가정이 있어야 평균 비교 모델을 쓰는 것이 가능

-    t-test, ANOVA

\[abstract\]- 🔖 표본크기가 30만 만족되면 t-test, ANOVA쓸 수 있다.

# 통계량과 확률분포

랜덤표본 X1, X2, . . . , Xn 의 함수인 통계량 u(X1, X2, . . . , Xn) 은 확률변수 로서 분포를 가짐. 이 통계량의 분포는 모집단 분포에 따라 결정됨.

# 표본분포 (Sampling Distribution)

통계량의 분포를 표본분포 (標本分布, sampling distribution) 라고 함.

# 신뢰구간은 통계량

-   통계량 : 랜덤표본의 함수 → 신뢰구간도 랜덤표본에 의해 구해지니, 통계량이다.

-   신뢰구간은 결국

-   추정량 ± (임계값) × (표준오차)

-   형태이며, 정규성 덕분에 정확한 유한표본 결과로 t분포가 등장한다는 점이 핵심이야

# 신뢰한계의 의미

-   예를 들어 95% 신뢰구간이라면

-   P(L ≤ μ ≤ U) = 0.95 의 의미는:

-   반복 표본추출을 하면 만들어진 구간의 95%가 참 모수를 포함한다 이지,

-   지금 계산한 특정 구간이 95% 확률로 모수를 포함한다는 뜻은 아니다 (모수는 고정값이니까).

# 표준오차

표본을 다시 뽑을 때마다 표본평균이 달라지는데 그 “달라지는 정도”를 수치로 나타낸 게 표준오차

# 선형 (linear)

## linear combination

-   Yi = β0 + β1X1i + β2X2i + ⋯ + βkXki

-   선형적으로 덧셈 → 단순선형

## linear relationship

-   직선 관계인지 아닌지

-   y = ax + b → 단순선형

## 단순선형회귀모형

Y를 알고 싶은데, 설명변수를 하나만 고려

Yi = β0 + β1Xi → 일반적인 직선

### 모형의 기본 형태

-   Yi = β0 + β1Xi + εi

-   Yi: 종속변수, 반응변수

-   Xi: 설명변수,입력변수

-   β0: 절편

-   β1: 기울기

-    εi: 오차항

### 조건부 기댓값

-   E(Yi ∣ Xi) = β0 + β1Xi

-   단순선형회귀는 Y의 조건부 기댓값이 X에 대해 선형이라고 가정하는 모형이다.

-   즉, 회귀직선은 단순히 데이터를 잘 맞추는 선이 아니라 "X가 주어졌을 때 Y의 평균"을 나타내는 함수

-   “Y 자체”를 설명하는 게 아니라 “Y의 조건부 평균”을 설명하는 것

# 다중선형회귀모형

## 모형의 형태

-   설명변수가 여러 개일 때:

-   Yi = β0 + β1X1i + β2X2i + ⋯ + βkXki + εi

-   Yi: 종속변수

-   X1i,..., Xki: 여러 설명변수

-   β0: 절편

-   βj: 각 설명변수의 효과

-   εi: 오차항

# 이항반응변수

-   반응변수가 0/1 (이항형)일 때,

-   선형회귀는 예측값이 0보다 작거나 1보다 클 수 있음 ❌

-   오차가 정규분포를 따르지 않음 ❌

1.  확률분포: Y ∼ Binomial(n, p)
2.  선형예측자 (linear predictor):

η = β0 + β1x1 + ⋯ + βpxp

# 피어슨 상관계수

## 단순선형회귀모형에서 기울기와의 비교

```{r}
# 🟧 데이터 선택 ===================
data(mtcars)
df <- mtcars

# 반응변수(y), 설명변수(x) 설정
y <- df$mpg
x <- df$wt

# 🟧 1) 단순선형회귀의 회귀계수 p값 ===================
fit <- lm(y ~ x)
fit_sum <- summary(fit)

# x의 회귀계수(기울기) p값
p_lm <- fit_sum$coefficients["x", "Pr(>|t|)"]

260211

10 / 11



# 결정계수와의 비교
# (참고) t 통계량도 같이 확인
t_lm <- fit_sum$coefficients["x", "t value"]
df_lm <- fit_sum$df[2] # 잔차 자유도 (n-2)

# 🟧 2) 피어슨 상관계수 유의성 검정 p값 ===================
ct <- cor.test(x, y, method = "pearson")

p_cor <- unname(ct$p.value)
r <- unname(ct$estimate)

# cor.test의 t 통계량은 r로부터 계산되는 t와 같음: t = r * sqrt((n-2)/(1-r^2))
n <- length(x)
t_from_r <- r * sqrt((n - 2) / (1 - r^2))

# 🟧 3) 결과 출력 및 동일성 확인 ===================
cat("=== 단순선형회귀 (lm) ===\n")
cat("t value (slope) =", t_lm, "\n")
cat("df (residual) =", df_lm, "\n")
cat("p-value (slope) =", p_lm, "\n\n")

cat("=== 피어슨 상관검정 (cor.test) ===\n")
cat("r =", r, "\n")
cat("t from r =", t_from_r, "\n")
cat("df =", n - 2, "\n")
cat("p-value (cor) =", p_cor, "\n\n")

cat("=== 비교 ===\n")
cat("p-value difference =", abs(p_lm - p_cor), "\n")
cat("all.equal(p_lm, p_cor) =", all.equal(p_lm, p_cor), "\n")
```

# 결정계수와의 비교

```{r}
# 🟧 데이터 선택 ===================
data(mtcars)
df <- mtcars

# 반응변수(y), 설명변수(x)
y <- df$mpg
x <- df$wt

# 🟧 1) 단순선형회귀의 R^2 ===================
fit <- lm(y ~ x)
fit_sum <- summary(fit)

R2_lm <- fit_sum$r.squared

# 🟧 2) 피어슨 상관계수의 제곱 ===================
r <- cor(x, y, method = "pearson")
R2_from_r <- r^2

# 🟧 3) 결과 비교 ===================
cat("=== 단순선형회귀 ===\n")
cat("R^2 (lm) =", R2_lm, "\n\n")

cat("=== 피어슨 상관계수 ===\n")
cat("r =", r, "\n")
cat("r^2 =", R2_from_r, "\n\n")

cat("=== 비교 ===\n")
cat("차이 =", abs(R2_lm - R2_from_r), "\n")
cat("all.equal(R2_lm, R2_from_r) =", all.equal(R2_lm, R2_from_r), "\n")
```
